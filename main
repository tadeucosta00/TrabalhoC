#include <stdio.h>
#include <stdlib.h>
#include <limits.h>
#include <conio.h>
#include <locale.h>

void MaisMenosCasos (int *casos, int contador);
void MelhorPiorAvaliacao(int *avaliacoes, int contadoravaliacao);
void Percentagem(int *casos, int *utentes, int contador);
int Verificapassgestor(char *password, char *passwordgestor);
int Verificapasequipa(char *password, char *passwordequipa);
int MenuSubmenu(void);
void MenuGestor(void);
void Menugeral(void);
const char* escolha();


int main(int argc, char *argv[]) {
	
	
	setlocale(LC_ALL, "Portuguese");
	
	int i,opcao,opcao2,verificadorpasswordgestor,verificadorpasswordequipa;
	char verificador;
	char passwordgestor[50] = "Gestor123456";	
	char passwordequipa[50] = "Equipa123456";
	char password[50];
	char ch;
	int casos[250], contador = 0, avaliacoes[250], contadoravaliacao = 0, percentagemCovid, utentes[250], contadorUtente = 0;
	char opcao1 = 's';
	

    Menugeral();
	verificador = escolha();
	
    if(verificador == 'G' || verificador == 'g')
	{	
		verificadorpasswordgestor = 0;
		verificadorpasswordgestor = Verificapassgestor(password,passwordgestor);
		if(verificadorpasswordgestor == 1){
		system("CLS");
		MenuGestor();
		}
		else 
		{
		printf("Password Invalida!!");
		}
    }
	else if(verificador == 'e' || verificador == 'E')
	{
		verificadorpasswordequipa = 0;
   		verificadorpasswordequipa = Verificapasequipa(password,passwordequipa);
		if(verificadorpasswordequipa == 1){
		system("CLS");
		MenuGestor();
		}
		else 
		{
		printf("Password Invalida!!");
		}
	}

	getchar();
	return 0;
}

//funcao verificar e escolher opcao gestor

int Verificapassgestor(char *password, char *passwordgestor)
{
	int i,verificador = 0;
	
		printf("Password:");
    	do{ 
        password[i]=getch(); 
        if(password[i]!='\r'){ 
            printf("*");
        } 
        i++; 
    	}while(password[i-1]!='\r');
    	password[i-1] = '\0';
	   
		printf("\n");
		if(strcmp(password,passwordgestor) == 0)
		{
		verificador = 1;
		}
		else
		{
		verificador = 0;		
		}
    	
    return verificador;	

}
//funcao verificar e escolher opcao equipa
int Verificapasequipa(char *password, char *passwordequipa)
{
	int i,verificador = 0;
	
		printf("Password:");
    	do{ 
        password[i]=getch(); 
        if(password[i]!='\r'){ 
            printf("*");
        } 
        i++; 
    	}while(password[i-1]!='\r');
    	password[i-1] = '\0';
	   
		printf("\n");
		if(strcmp(password,passwordequipa) == 0)
		{
		verificador = 1;
		}
		else
		{
		verificador = 0;		
		}
    	
    return verificador;	

}
//funcao para sub menu
int MenuSubmenu(void)
{  
    int opcao2;
    int contador  = 1;
    while (contador)
    {
    	printf("1-Inserir dados equipa\n");
    	printf("2-Inserir dados Lares\n");
    	printf("0-Voltar ao menu Principal\n");
    	printf("Opção:");
        scanf(" %d", &opcao2);

        switch (opcao2)
        {
        case 1:
            printf(".......	em construçao......\n");
            break;

        case 2:
           
            printf(".......	em construçao......\n");
            break;

        case 0:
           	system("CLS");
		    contador = 0;  
            MenuGestor();

        default:
            printf("Invalid choice.\n");
            break;
        }
    }
}
//funcao para sub menu
void Menugeral(void)
{
		char verificador;
		puts("---------Sistema de Lares---------");
		printf("Gestor --- G \n");
		printf("Equipa --- E \n");
		printf("Opcao: ");			
}

//funcao 
void MenuGestor(void)
{  	
	int contador = 1;
    while (contador)
    {
        puts("---------Bem vindo..........\n");
		printf("1-Inserir dados\n");
		printf("2-Editar dados existentes\n");
		printf("3-Eliminar dados existentes\n");
		printf("4-Imprimir relatorio\n");
		printf("5-Imprimir Estatiscas\n");			
		printf("0-Menu de usuarios\n");
		printf("Opçao: ");
        int opcao;
        scanf(" %d", &opcao);

        switch (opcao)
        {
        case 1:
        	system("CLS");
            MenuSubmenu();
            break;

        case 2:
            printf(".......	em construçao......\n");
            break;

        case 3:
            contador = 0;  
            break;
		case 0:
			system("CLS");
            Menugeral();
            escolha();
            
            break;
        default:
            printf("Escolha invalida.\n");
            break;
        }
    }		
}

const char* escolha()
{
	char verificador;
    scanf(" %c",&verificador);
    return verificador;
}

//funcao para ver os lares com mais e menos casos
void MaisMenosCasos (int *casos, int contador)
{
	int maior = -500, menor = 500, i;
		
	for( i = 0; i < contador; i++)
	{
		if (casos[i] > maior) 	
		{
			maior = casos[i]; 
		}
	}

	
	for( i = 0; i < contador; i++)
	{
		if (casos[i] < menor)
		{
			menor = casos[i];
		}
	}
	if(menor != 500)
	{
		printf("O lar com mais casos têm %d \n", maior);
		printf("\nO lar com menos casos têm %d \n", menor); 	
	}
	else 
	{
		puts("\nNos lares inseridos não houve nenhum caso de Covid");	
	}
}
//funcao para ver a melhor e a pior avaliçao dos lares
void MelhorPiorAvaliacao(int *avaliacoes, int contadoravaliacao)
{
		int maior = -500, menor = 500, i;
		
	for( i = 0; i < contadoravaliacao; i++)
	{
		if (avaliacoes[i] > maior) 	
		{
			maior = avaliacoes[i]; 
		}
	}

	
	for( i = 0; i < contadoravaliacao; i++)
	{
		if (avaliacoes[i] < menor)
		{
			menor = avaliacoes[i];
		}
	}
	if(menor != 500)
	{
		printf("\nA melhor avaliação dos lares é %d \n", maior);
		printf("\nO A pior avaliação dos lares é %d \n", menor); 	
	}
	else 
	{
		puts("\nNos lares inseridos não houve nenhum caso de Covid");	
	}	
}
//funcao para calcular a percentagem
void Percentagem(int *casos, int *utentes, int contador)
{
	int i, calculo, percentagem;
	for( i = 0; i < contador; i++)
	{
		calculo = casos[i] * 100;
		percentagem = calculo / utentes[i];
		printf("\nA percentagem por este lar é de %d\n", percentagem);
	}
	
}
